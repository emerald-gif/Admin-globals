<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Admin Dashboard - 2025 Fintech UI</title>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
  <script src="https://unpkg.com/lucide@latest"></script>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
  
 


  <style>
    .dashboard-card {
      @apply bg-white rounded-2xl shadow-lg p-6 border border-gray-100;
    }
  </style>
</head>
<body class="bg-gray-50 text-gray-800 font-sans">

  <div class="min-h-screen flex">
    <!-- Sidebar -->
    <aside class="w-64 bg-white shadow-xl rounded-r-3xl p-5">
      <div class="text-2xl font-bold text-blue-700 mb-6">Globals Admin</div>
      <nav class="space-y-4">
        <button class="flex items-center w-full gap-3 text-left text-gray-700 hover:text-blue-700" onclick="switchTab('overview')">
          <i data-lucide="bar-chart-3" class="w-5 h-5"></i> Overview
        </button>
        <button class="flex items-center w-full gap-3 text-left text-gray-700 hover:text-blue-700" onclick="switchTab('users')">
          <i data-lucide="users" class="w-5 h-5"></i> Users
        </button>
        <button class="flex items-center w-full gap-3 text-left text-gray-700 hover:text-blue-700" onclick="switchTab('adminReviewJobsSection')">
          <i data-lucide="clipboard-list" class="w-5 h-5"></i> Affiliate/Tasks Jobs
        </button>
        <button class="flex items-center w-full gap-3 text-left text-gray-700 hover:text-blue-700" onclick="switchTab('taskSubmissionsTab')">
          <i data-lucide="file-check" class="w-5 h-5"></i> Task Submissions
        </button>

        <button class="flex items-center w-full gap-3 text-left text-gray-700 hover:text-blue-700" onclick="switchTab('adminPostJob')">
          <i data-lucide="file-check" class="w-5 h-5"></i> Post Admin Job
        </button>

        <button class="flex items-center w-full gap-3 text-left text-gray-700 hover:text-blue-700" onclick="switchTab('withdrawals')">
          <i data-lucide="banknote" class="w-5 h-5"></i> Withdrawals
        </button>

        <button class="flex items-center w-full gap-3 text-left text-gray-700 hover:text-blue-700" onclick="switchTab('adminNotificationSender')">
          <i data-lucide="banknote" class="w-5 h-5"></i> Notification
        </button>

        <button class="flex items-center w-full gap-3 text-left text-gray-700 hover:text-blue-700" onclick="switchTab('social-tasks-admin')">
          <i data-lucide="banknote" class="w-5 h-5"></i> Social Tasks
        </button>


        <button class="flex items-center w-full gap-3 text-left text-gray-700 hover:text-blue-700" 
        onclick="switchTab('bills-admin')">
  <i data-lucide="smartphone" class="w-5 h-5"></i> Airtime & Data
</button>

        
        <button class="flex items-center w-full gap-3 text-left text-gray-700 hover:text-blue-700" onclick="switchTab('team')">
          <i data-lucide="banknote" class="w-5 h-5"></i> Referral Stat
        </button>



      </nav>
    </aside>

    <!-- Content Area -->
    <main class="flex-1 p-6 overflow-y-auto">
      <!-- Overview -->
      <section id="overview" class="tab">
        <h2 class="text-2xl font-bold mb-6">Overview</h2>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
          <div class="dashboard-card">
            <p class="text-sm text-gray-500">Total Users</p>
            <p class="text-3xl font-semibold text-blue-600" id="user-count">Loading...</p>
          </div>
          <div class="dashboard-card">
            <p class="text-sm text-gray-500">Tasks Submitted</p>
            <p class="text-3xl font-semibold text-purple-600" id="task-count">Loading...</p>
          </div>
          <div class="dashboard-card">
            <p class="text-sm text-gray-500">Total Withdrawals</p>
            <p class="text-3xl font-semibold text-green-600" id="withdrawal-count">Loading...</p>
          </div>
        </div>
      </section>

      <!-- Users -->
      <section id="users" class="tab hidden mt-6">
        <h2 class="text-2xl font-bold mb-4">Users</h2>
        <div id="user-list" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div>
      </section>

      <!-- Tasks -->
      <section id="adminReviewJobsSection" class="tab hidden mt-6">
        <h2 class="text-2xl font-bold mb-4">Pending Job Approvals</h2>
        <div id="adminPendingJobs" class="space-y-4"></div>
      </section>

      <!-- Task Submissions -->
      <section id="taskSubmissionsTab" class="tab hidden mt-6">
        <h2 class="text-2xl font-bold mb-4">Task Submissions</h2>
        <div id="task-submissions-list" class="space-y-4"></div>
      </section>

      <!-- Review Section -->
      <section id="review-section" class="hidden mt-6">
        <button onclick="backToSubmissions()" class="mb-4 text-blue-600 hover:underline">‚Üê Back to Submissions</button>
        <div id="review-content" class="bg-white p-6 rounded-2xl shadow-xl"></div>
      </section>

      <!-- Withdrawals -->
      <section id="withdrawals" class="tab hidden mt-6">
        <h2 class="text-2xl font-bold mb-4">Withdrawal Requests</h2>
        <div id="withdrawal-list" class="space-y-4"></div>
      </section>

      

      <!-- ================== POST ADMIN JOB FORM ================== -->
<section id="adminPostJob" class="hidden p-4">
  <h2 class="text-xl font-bold mb-4">Post Admin Job</h2>

  <div class="space-y-4">
    <input id="adminJobCategory" type="text" placeholder="Category"
      class="w-full border rounded-lg p-2" />

    <input id="adminJobTitle" type="text" placeholder="Job Title"
      class="w-full border rounded-lg p-2" />

    <textarea id="adminJobInstructions" placeholder="Instructions"
      class="w-full border rounded-lg p-2"></textarea>

    <input id="adminJobTargetLink" type="url" placeholder="Target Link"
      class="w-full border rounded-lg p-2" />

    <input id="adminJobProofRequired" type="text" placeholder="Proof Required"
      class="w-full border rounded-lg p-2" />

    <input id="adminJobNumWorkers" type="number" placeholder="Number of Workers"
      class="w-full border rounded-lg p-2" />

    <input id="adminJobWorkerPay" type="number" placeholder="Pay per Worker (‚Ç¶)"
      class="w-full border rounded-lg p-2" />

    <input id="adminJobProofFileCount" type="number" placeholder="Number of Proof Files" value="1"
      class="w-full border rounded-lg p-2" />

    <label class="block font-semibold">Campaign Logo</label>
    <input id="adminJobLogoFile" type="file" accept="image/*"
      class="w-full border rounded-lg p-2" />

    <button onclick="submitAdminJob()" class="bg-green-500 text-white px-4 py-2 rounded-lg">
      Post Job
    </button>
  </div>
</section>








<!-- ===== Social Tasks Admin (Modern, Searchable, Transaction-safe) ===== -->
<div id="social-tasks-admin" class="p-6 bg-gradient-to-br from-gray-50 to-gray-100 min-h-screen">
  <!-- Header -->
  <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6">
    <h2 class="text-3xl font-extrabold text-gray-800 flex items-center gap-3">üìã Social Tasks Review</h2>

    <div class="flex gap-2 items-center">
      <button id="refreshBtn" class="px-4 py-2 rounded-lg bg-white shadow hover:bg-gray-50">üîÑ Refresh</button>
    </div>
  </div>

  <!-- Quick Stats + Controls -->
  <div class="grid grid-cols-1 lg:grid-cols-3 gap-4 mb-6">
    <!-- Stats -->
    <div class="col-span-1 grid grid-cols-3 gap-3">
      <div class="stat-card bg-white p-4 rounded-2xl shadow flex flex-col items-center">
        <span class="text-gray-500 text-sm">‚è≥ Pending</span>
        <span id="pendingCount" class="text-2xl font-bold text-blue-600 mt-1">0</span>
      </div>
      <div class="stat-card bg-white p-4 rounded-2xl shadow flex flex-col items-center">
        <span class="text-gray-500 text-sm">‚úÖ Approved</span>
        <span id="approvedCount" class="text-2xl font-bold text-green-600 mt-1">0</span>
      </div>
      <div class="stat-card bg-white p-4 rounded-2xl shadow flex flex-col items-center">
        <span class="text-gray-500 text-sm">‚ùå Rejected</span>
        <span id="rejectedCount" class="text-2xl font-bold text-red-600 mt-1">0</span>
      </div>
    </div>

    <!-- Primary controls: tabs + status filter -->
    <div class="col-span-1 bg-white rounded-2xl p-4 shadow flex flex-col gap-3">
      <div class="flex gap-2">
        <button onclick="setCollection('TiktokInstagram', this)" class="tab-btn active">TikTok / Instagram</button>
        <button onclick="setCollection('Whatsapp', this)" class="tab-btn">WhatsApp</button>
        <button onclick="setCollection('Telegram', this)" class="tab-btn">Telegram</button>
      </div>

      <div class="flex gap-2 mt-2">
        <button onclick="setStatusFilter('pending', this)" class="filter-btn active">‚è≥ Pending</button>
        <button onclick="setStatusFilter('approved', this)" class="filter-btn">‚úÖ Approved</button>
        <button onclick="setStatusFilter('rejected', this)" class="filter-btn">‚ùå Rejected</button>
        <button onclick="setStatusFilter('all', this)" class="filter-btn">All</button>
      </div>
    </div>

    <!-- Search / Sort / Date -->
    <div class="col-span-1 bg-white rounded-2xl p-4 shadow flex flex-col gap-3">
      <input id="searchInput" type="search" placeholder="Search by user ID, username, link..." class="p-3 rounded-lg border" />
      <div class="flex gap-2">
        <select id="sortSelect" onchange="setSort(this.value)" class="p-2 rounded-lg border">
          <option value="newest">Newest</option>
          <option value="oldest">Oldest</option>
        </select>
        <input id="startDate" type="date" onchange="setDateRange()" class="p-2 rounded-lg border" />
        <input id="endDate" type="date" onchange="setDateRange()" class="p-2 rounded-lg border" />
      </div>
    </div>
  </div>

  <!-- Task Container -->
  <div id="tasksContainer" class="grid gap-6 md:grid-cols-2 lg:grid-cols-3"></div>

  <!-- Load more -->
  <div class="mt-6 text-center">
    <button id="loadMoreBtn" class="px-5 py-2 rounded-lg bg-white shadow hidden">Load more</button>
  </div>
</div>

<!-- Image modal -->
<div id="imageModal" class="hidden fixed inset-0 z-50 bg-black bg-opacity-70 flex items-center justify-center p-4">
  <div class="bg-white rounded-lg max-w-3xl w-full p-4">
    <img id="imageModalImg" src="" class="w-full h-auto rounded" />
    <div class="mt-3 text-right">
      <button onclick="closeImageModal()" class="px-4 py-2 rounded bg-gray-200">Close</button>
    </div>
  </div>
</div>

<!-- Confirm modal (Approve / Reject) -->
<div id="confirmModal" class="hidden fixed inset-0 z-60 bg-black bg-opacity-40 flex items-center justify-center p-4">
  <div class="bg-white rounded-lg w-full max-w-lg p-6">
    <h3 id="confirmTitle" class="text-lg font-bold mb-3">Confirm</h3>
    <p id="confirmText" class="text-sm text-gray-700 mb-4"></p>

    <div id="rejectReasonWrap" class="mb-4 hidden">
      <label class="block text-sm text-gray-600 mb-1">Reject Reason (optional)</label>
      <textarea id="rejectReason" class="w-full p-3 border rounded-lg" rows="3"></textarea>
    </div>

    <div class="flex gap-3 justify-end">
      <button onclick="closeConfirmModal()" class="px-4 py-2 rounded bg-gray-100">Cancel</button>
      <button id="confirmActionBtn" class="px-4 py-2 rounded bg-green-500 text-white">Confirm</button>
    </div>
  </div>
</div>

<style>
  /* small UI polish */
  .tab-btn, .filter-btn {
    padding: 8px 12px;
    border-radius: 10px;
    background: #f1f5f9;
    cursor: pointer;
    font-weight: 600;
    transition: all 0.15s ease;
  }
  .tab-btn:hover, .filter-btn:hover { transform: translateY(-2px); }
  .tab-btn.active, .filter-btn.active {
    background: #2563eb; color: #fff;
    box-shadow: 0 6px 18px rgba(37,99,235,0.16);
  }
  .task-card {
    border-radius: 12px;
    padding: 16px;
    background: white;
    border: 1px solid #e6eefb;
    box-shadow: 0 6px 18px rgba(2,6,23,0.03);
  }
  .task-badge { display:inline-block; padding:6px 10px; border-radius:999px; font-weight:700; font-size:12px; }
  .badge-pending { background: #fff7ed; color: #b45309; }
  .badge-approved { background:#ecfdf5; color:#15803d; }
  .badge-rejected { background:#fff1f2; color:#b91c1c; }
  .task-thumb { max-width:120px; border-radius:10px; margin-top:8px; border:1px solid #e6eefb; cursor:pointer; }
  .task-meta { font-size:13px; color:#374151; margin-bottom:6px; }
</style>


      





<!-- üì≤ Airtime & Data Requests -->
<!-- ===== Airtime & Data Admin (2025 UI) ===== -->


<!-- üì≤ Airtime & Data Requests -->
<!-- üì≤ Airtime & Data Requests -->
<div id="bills-admin" class="tab-section hidden p-6 bg-gradient-to-br from-gray-50 via-white to-gray-50 min-h-screen">

  <!-- Header -->
  <div class="flex items-center justify-between mb-6">
    <h2 class="text-2xl font-extrabold text-gray-800 flex items-center gap-2">
      <span class="text-blue-600">üì≤</span> Airtime & Data Requests
    </h2>
  </div>

  <!-- Tabs: Airtime / Data -->
  <div class="flex gap-4 border-b mb-6">
    <button onclick="switchBillType('airtime')" id="tab-airtime"
      class="px-4 py-2 font-medium text-blue-600 border-b-2 border-blue-600">
      Airtime
    </button>
    <button onclick="switchBillType('data')" id="tab-data"
      class="px-4 py-2 font-medium text-gray-500 hover:text-blue-600">
      Data
    </button>
  </div>

  <!-- Subtabs: Pending / Successful / Failed -->
  <div class="flex gap-3 mb-6 bg-gray-100 p-1 rounded-full w-fit shadow-inner">
    <button onclick="switchBillStatus('pending')" id="subtab-pending"
      class="px-5 py-2 text-sm font-medium rounded-full bg-blue-600 text-white shadow-md transition">
      Pending
    </button>
    <button onclick="switchBillStatus('successful')" id="subtab-successful"
      class="px-5 py-2 text-sm font-medium rounded-full text-gray-600 hover:text-blue-600 transition">
      Successful
    </button>
    <button onclick="switchBillStatus('failed')" id="subtab-failed"
      class="px-5 py-2 text-sm font-medium rounded-full text-gray-600 hover:text-blue-600 transition">
      Failed
    </button>
  </div>

  <!-- Requests Grid -->
  <div id="billsContainer" class="grid gap-6 md:grid-cols-2 lg:grid-cols-3"></div>
</div>
      


<!-- ========================
 üìä Referral Dashboard Section
 ======================== -->
<section id="team" class="hidden px-5 sm:px-8 pb-16 space-y-8">

  <!-- KPI Cards -->
  <div class="grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-4 gap-4">
    <div class="glass p-5">
      <div class="text-sm text-gray-500">Total Users</div>
      <div id="kpiTotalUsers" class="metric text-3xl font-semibold mt-2">0</div>
      <div class="text-xs text-gray-400 mt-1">All registered accounts</div>
    </div>
    <div class="glass p-5">
      <div class="text-sm text-gray-500">Total Referrals</div>
      <div id="kpiTotalReferrals" class="metric text-3xl font-semibold mt-2">0</div>
      <div class="text-xs text-gray-400 mt-1">Users who signed up via a referrer</div>
    </div>
    <div class="glass p-5">
      <div class="text-sm text-gray-500">Premium Users</div>
      <div id="kpiPremium" class="metric text-3xl font-semibold mt-2">0</div>
      <div class="text-xs text-gray-400 mt-1">is_Premium = true</div>
    </div>
    <div class="glass p-5">
      <div class="text-sm text-gray-500">Commission Paid</div>
      <div id="kpiCommission" class="metric text-3xl font-semibold mt-2">‚Ç¶0</div>
      <div class="text-xs text-gray-400 mt-1">Based on credited premium referrals</div>
    </div>
  </div>

  <!-- Chart + Leaderboard -->
  <div class="grid grid-cols-1 xl:grid-cols-3 gap-4">
    <div class="glass p-5 xl:col-span-2">
      <div class="flex items-center justify-between">
        <div class="font-semibold text-blue-700">Referral Trend (Last 14 Days)</div>
        <div class="text-xs text-gray-500">Based on user <code>joinedAt</code></div>
      </div>
      <div class="mt-4">
        <canvas id="trendChart" height="90"></canvas>
      </div>
      <div id="chartNote" class="text-xs text-gray-500 mt-3 hidden">
        Some users don‚Äôt have <code>joinedAt</code>. Those entries are skipped.
      </div>
    </div>

    <div class="glass p-5">
      <div class="flex items-center justify-between">
        <div class="font-semibold text-blue-700">Top Referrers</div>
        <div class="text-xs text-gray-500">Direct premium conversions</div>
      </div>
      <div class="mt-4 overflow-auto max-h-96 scroll-slim">
        <table class="min-w-full table">
          <thead>
            <tr class="text-xs text-gray-500">
              <th class="text-left py-2 pr-2">User</th>
              <th class="text-right py-2 pr-2">Referrals</th>
              <th class="text-right py-2">Earnings</th>
            </tr>
          </thead>
          <tbody id="leaderboardBody"></tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- Per-user Explorer -->
  <div class="glass p-5">
    <div class="flex flex-col md:flex-row md:items-end md:justify-between gap-4">
      <div>
        <div class="font-semibold text-blue-700">User Explorer</div>
        <div class="text-xs text-gray-500">Search any <span class="font-medium">@username</span> to see their referral tree</div>
      </div>
      <div class="flex items-center gap-2">
        <div class="relative">
          <span class="absolute left-3 top-2.5 text-gray-400">@</span>
          <input id="searchUsername" class="pl-7 pr-3 py-2 rounded-xl border border-blue-100 focus:ring-2 focus:ring-blue-500 focus:outline-none"
                 placeholder="username e.g. globals_admin"/>
        </div>
        <button id="searchBtn" class="btn-primary">Explore</button>
      </div>
    </div>

    <div id="userPanel" class="mt-6 hidden">
      <div class="grid grid-cols-1 lg:grid-cols-3 gap-4">
        <div class="glass p-4">
          <div class="text-sm text-gray-500">Direct Referrals</div>
          <div id="uDirectCount" class="metric text-2xl font-semibold mt-1">0</div>
        </div>
        <div class="glass p-4">
          <div class="text-sm text-gray-500">Second Level</div>
          <div id="uSecondCount" class="metric text-2xl font-semibold mt-1">0</div>
        </div>
        <div class="glass p-4">
          <div class="text-sm text-gray-500">Referral Earnings</div>
          <div id="uEarnings" class="metric text-2xl font-semibold mt-1">‚Ç¶0</div>
        </div>
      </div>

      <div class="mt-6 flex items-center gap-2">
        <input id="userRefLink" class="flex-1 px-3 py-2 rounded-xl border border-blue-100 bg-white" readonly />
        <button id="copyLinkBtn" class="btn-soft">Copy</button>
        <button id="shareLinkBtn" class="btn-primary">Share</button>
      </div>

      <div class="mt-6">
        <div class="font-medium text-blue-700 mb-2">Direct Referrals</div>
        <div id="uList" class="grid sm:grid-cols-2 xl:grid-cols-3 gap-3"></div>
      </div>
    </div>
  </div>

  </section>

      

    <style>
      
/* 2025 fintech vibe */
.glass {
  background: rgba(255,255,255,.65);
  backdrop-filter: blur(14px);
  -webkit-backdrop-filter: blur(14px);
  box-shadow: 0 12px 35px rgba(30,64,175,.12), inset 0 1px 0 rgba(255,255,255,.6);
  border: 1px solid rgba(59,130,246,.08);
  border-radius: 20px;
}
.metric {
  font-feature-settings: "tnum";
  font-variant-numeric: tabular-nums;
}
.btn-primary {
  background: linear-gradient(135deg,#2563eb,#1d4ed8);
  color:#fff;
  border-radius:12px;
  padding:.65rem 1rem;
  box-shadow:0 10px 24px rgba(37,99,235,.25);
  transition: transform .12s ease, box-shadow .12s ease;
}
.btn-primary:hover {
  transform: translateY(-1px);
  box-shadow:0 14px 28px rgba(37,99,235,.28);
}
.btn-soft {
  background: rgba(37,99,235,.08);
  color:#1d4ed8;
  border-radius:12px;
  padding:.65rem 1rem;
}
.table th{ font-weight:600; color:#1f2937; }
.table td{ color:#374151; }
.scroll-slim::-webkit-scrollbar{ height:8px; width:8px; }
.scroll-slim::-webkit-scrollbar-thumb{ background: rgba(49,130,246,.25); border-radius:9999px; }

    </style>


      

      







                      <!-- ADMIN NOTIFICATION-->
      
      <div id="adminNotificationSender" class="hidden px-4 pt-6 pb-24 max-w-4xl mx-auto">
  <h2 class="text-2xl font-bold mb-4 text-blue-700">Admin Notifications</h2>
  
  <!-- Title -->
  <input type="text" id="notifTitle" placeholder="Title" class="w-full mb-3 p-2 border rounded" />
  
  <!-- Message -->
  <textarea id="notifMessage" placeholder="Message" class="w-full p-2 border rounded mb-3"></textarea>

  <!-- Actions -->
  <div class="grid grid-cols-1 md:grid-cols-2 gap-3 mb-6">
    <button onclick="sendDashboardNotification()" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded w-full">Send to Dashboard Only</button>
    <button onclick="sendEmailNotification()" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded w-full">Send Email Only</button>
  </div>

  <!-- Email Template Editor -->
  <h3 class="text-lg font-semibold mt-8 mb-2">Edit Email Template</h3>
  <textarea id="emailTemplateEditor" class="w-full h-96 p-3 border rounded font-mono text-sm" placeholder="Paste or edit your HTML template here..."></textarea>
  
  <div class="mt-3 flex gap-3">
    <button onclick="saveEmailTemplate()" class="bg-yellow-500 hover:bg-yellow-600 text-white px-4 py-2 rounded">Save Template</button>
    <button onclick="resetDefaultTemplate()" class="bg-gray-400 hover:bg-gray-500 text-white px-4 py-2 rounded">Reset to Default</button>
  </div>
</div>



    </main>
  </div>

  <script>
    lucide.createIcons();
  </script>
  <script src="admin.js"></script>
</body>

</html>














